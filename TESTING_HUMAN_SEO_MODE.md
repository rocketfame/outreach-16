# Інструкція з тестування Human Mode та SEO Mode

## Огляд функціоналу

Система підтримує два режими написання статей:
- **SEO Mode** (режим за замовчуванням): SEO-оптимізована структура з чіткими заголовками, списками та формалізованим форматом
- **Human Mode** (експериментальний): Редакційний стиль, природний потік, варіативна структура, менш жорсткі шаблони

## Передумови для тестування

### 1. Увімкнення feature flag

Для доступу до Human Mode необхідно увімкнути feature flag:

1. Відкрийте файл `.env.local` в корені проекту
2. Додайте або змініть змінну:
   ```bash
   NEXT_PUBLIC_HUMAN_MODE_EXPERIMENT=true
   ```
3. Перезапустіть dev сервер:
   ```bash
   npm run dev
   ```

**Важливо:** Якщо feature flag вимкнений (`false` або відсутній), UI показує тільки SEO Mode, але система працює як раніше.

### 2. Перевірка налаштувань

Переконайтеся, що у вас налаштовані:
- ✅ OpenAI API ключ (`OPENAI_API_KEY`)
- ✅ Tavily API ключ (`TAVILY_API_KEY`)
- ✅ Всі інші необхідні змінні середовища

## Тестування SEO Mode

### Тест 1: Базова генерація в SEO Mode

**Кроки:**
1. Відкрийте додаток у браузері
2. Переконайтеся, що вибрано **SEO Mode** (має бути активним за замовчуванням)
3. Заповніть Project Basics:
   - Niche: наприклад, "music industry"
   - Platform: наприклад, "Spotify"
   - Language: "English"
   - Word count: "1200"
   - Content purpose: "guest post / outreach"
4. Заповніть Branded link details (anchor text та URL)
5. Згенеруйте топики (Topic Discovery Mode) або введіть тему (Direct Mode)
6. Згенеруйте статтю

**Що перевірити:**
- ✅ Стаття має чітку структуру з H1, H2, H3 заголовками
- ✅ Використовуються списки (bullets/numbered lists) для організації контенту
- ✅ Текст має формалізований, професійний тон
- ✅ Структура відповідає класичному SEO-шаблону (Intro → Sections → Conclusion)
- ✅ Налаштування Humanize доступні та працюють (якщо увімкнено)

### Тест 2: SEO Mode з Humanize

**Кроки:**
1. Увімкніть toggle "Humanize on write" в SEO Mode
2. Розгорніть "Show settings" для налаштування Humanize
3. Виберіть різні комбінації:
   - Model Quality: Quality (0), Balance (1), Enhanced (2)
   - Mode: Basic або Autopilot
4. Згенеруйте статтю

**Що перевірити:**
- ✅ Humanize налаштування доступні тільки в SEO Mode
- ✅ Стаття проходить через humanization процес
- ✅ Різні моделі та режими працюють коректно
- ✅ Текст стає більш природним, але структура залишається SEO-оптимізованою

### Тест 3: SEO Mode без Humanize

**Кроки:**
1. Вимкніть toggle "Humanize on write"
2. Згенеруйте статтю

**Що перевірити:**
- ✅ Стаття генерується без humanization
- ✅ Структура залишається SEO-оптимізованою
- ✅ Текст може містити більше AI-індикаторів (em-dash, smart quotes тощо)

## Тестування Human Mode

### Тест 4: Базова генерація в Human Mode

**Кроки:**
1. Увімкніть feature flag (якщо ще не увімкнено)
2. Перемкніть Writing Mode на **Human Mode**
3. Заповніть Project Basics (як у Тесті 1)
4. Згенеруйте статтю

**Що перевірити:**
- ✅ Стаття має менш формалізовану структуру
- ✅ Використовується менше списків, більше наративного тексту
- ✅ Параграфи мають різну довжину (короткі та довгі)
- ✅ Тон більш редакційний, менш формальний
- ✅ Можуть бути присутні легкі суб'єктивні висловлювання
- ✅ **Humanize автоматично увімкнено** (незалежно від UI toggle)
- ✅ Налаштування Humanize **приховані** в Human Mode

### Тест 5: Human Mode - перевірка автоматичного Humanize

**Кроки:**
1. Перемкніть на Human Mode
2. Переконайтеся, що toggle "Humanize on write" вимкнений (або увімкнений - не має значення)
3. Згенеруйте статтю
4. Перевірте в консолі браузера або network tab

**Що перевірити:**
- ✅ В API запиті `effectiveHumanizeOnWrite` завжди `true` для Human Mode
- ✅ Показується інформаційне повідомлення: "Human Mode: Humanization is automatically enabled"
- ✅ Стаття проходить через humanization процес незалежно від UI toggle
- ✅ Текст очищається від AI-індикаторів (em-dash, smart quotes, zero-width spaces)

### Тест 6: Human Mode - структура статті

**Кроки:**
1. Згенеруйте кілька статей в Human Mode
2. Порівняйте структуру з SEO Mode

**Що перевірити:**
- ✅ Менше H2 заголовків (2-5 замість багатьох)
- ✅ Немає жорсткого шаблону "Intro → 3 секції → Conclusion"
- ✅ Параграфи різної довжини
- ✅ Менше списків, більше наративного тексту
- ✅ Відсутні шаблонні фрази типу "In this article, we will discuss..."
- ✅ Відсутні фрази типу "In conclusion", "The key takeaway is..."

### Тест 7: Human Mode - стиль та голос

**Кроки:**
1. Згенеруйте статтю в Human Mode
2. Прочитайте текст вручну

**Що перевірити:**
- ✅ Змішування довгих та коротких речень
- ✅ Можливі легкі суб'єктивні висловлювання ("I keep seeing...", "Honestly...")
- ✅ Тон звучить як розмова з колегою, а не як туторіал
- ✅ Відсутній надмірно формальний, нейтральний тон
- ✅ Деякі думки можуть бути трохи відкритими (не все пояснено крок за кроком)

## Тестування перемикання між режимами

### Тест 8: Перемикання режимів

**Кроки:**
1. Згенеруйте статтю в SEO Mode
2. Перемкніть на Human Mode
3. Згенеруйте нову статтю
4. Поверніться до SEO Mode
5. Згенеруйте ще одну статтю

**Що перевірити:**
- ✅ Режим зберігається між сесіями (через localStorage)
- ✅ UI коректно відображає поточний режим
- ✅ Кожна стаття генерується з правильним режимом
- ✅ Налаштування Humanize з'являються/зникають коректно

### Тест 9: Режим зберігається після перезавантаження

**Кроки:**
1. Виберіть Human Mode
2. Згенеруйте статтю
3. Перезавантажте сторінку (F5)

**Що перевірити:**
- ✅ Human Mode залишається вибраним після перезавантаження
- ✅ Налаштування зберігаються в localStorage

## Тестування обох режимів (Topic Discovery та Direct Mode)

### Тест 10: Topic Discovery Mode - SEO Mode

**Кроки:**
1. Виберіть Topic Discovery Mode
2. Виберіть SEO Mode
3. Згенеруйте топики
4. Виберіть топики та згенеруйте статті

**Що перевірити:**
- ✅ Топики генеруються коректно
- ✅ Статті мають SEO-структуру
- ✅ Humanize налаштування доступні

### Тест 11: Topic Discovery Mode - Human Mode

**Кроки:**
1. Виберіть Topic Discovery Mode
2. Виберіть Human Mode
3. Згенеруйте топики
4. Виберіть топики та згенеруйте статті

**Що перевірити:**
- ✅ Топики генеруються коректно
- ✅ Статті мають редакційну структуру
- ✅ Humanize автоматично увімкнено
- ✅ Humanize налаштування приховані

### Тест 12: Direct Article Creation Mode - SEO Mode

**Кроки:**
1. Перемкніть на Direct Article Creation Mode
2. Виберіть SEO Mode
3. Введіть тему статті
4. Згенеруйте статтю

**Що перевірити:**
- ✅ Стаття генерується з SEO-структурою
- ✅ Humanize налаштування доступні

### Тест 13: Direct Article Creation Mode - Human Mode

**Кроки:**
1. Перемкніть на Direct Article Creation Mode
2. Виберіть Human Mode
3. Введіть тему статті
4. Згенеруйте статтю

**Що перевірити:**
- ✅ Стаття генерується з редакційною структурою
- ✅ Humanize автоматично увімкнено
- ✅ Humanize налаштування приховані

## Тестування edge cases

### Тест 14: Feature flag вимкнений

**Кроки:**
1. Встановіть `NEXT_PUBLIC_HUMAN_MODE_EXPERIMENT=false` або видаліть змінну
2. Перезапустіть сервер
3. Перезавантажте сторінку

**Що перевірити:**
- ✅ Toggle Writing Mode не відображається
- ✅ Система працює тільки в SEO Mode
- ✅ Humanize налаштування доступні як завжди
- ✅ Немає помилок в консолі

### Тест 15: Регенерація статті в різних режимах

**Кроки:**
1. Згенеруйте статтю в SEO Mode
2. Збережіть її
3. Перемкніть на Human Mode
4. Згенеруйте нову статтю
5. Спробуйте регенерувати стару статтю (якщо можливо)

**Що перевірити:**
- ✅ Стара стаття зберігає свій режим
- ✅ Нова стаття генерується в Human Mode
- ✅ Регенерація використовує правильний режим

### Тест 16: Перевірка API запитів

**Кроки:**
1. Відкрийте DevTools → Network tab
2. Згенеруйте статтю в SEO Mode (з Humanize вимкненим)
3. Згенеруйте статтю в SEO Mode (з Humanize увімкненим)
4. Згенеруйте статтю в Human Mode

**Що перевірити:**
- ✅ SEO Mode без Humanize: `humanizeOnWrite: false`
- ✅ SEO Mode з Humanize: `humanizeOnWrite: true`
- ✅ Human Mode: `humanizeOnWrite: true` (навіть якщо toggle вимкнений)
- ✅ `writingMode` передається коректно: `"seo"` або `"human"`

## Перевірка якості контенту

### Тест 17: Порівняння SEO Mode vs Human Mode

**Кроки:**
1. Згенеруйте статтю на одну тему в SEO Mode
2. Згенеруйте статтю на ту саму тему в Human Mode
3. Порівняйте результати

**Що перевірити:**

**SEO Mode має мати:**
- ✅ Більше структурованих списків
- ✅ Більше H2/H3 заголовків
- ✅ Формалізований тон
- ✅ Чітка структура Intro → Sections → Conclusion
- ✅ Більше SEO-оптимізації

**Human Mode має мати:**
- ✅ Більше наративного тексту
- ✅ Менше списків
- ✅ Редакційний тон
- ✅ Варіативна структура
- ✅ Природніший потік тексту
- ✅ Менше AI-індикаторів (завдяки автоматичному humanize)

### Тест 18: Перевірка очищення AI-індикаторів

**Кроки:**
1. Згенеруйте статті в обох режимах
2. Перевірте текст на наявність:
   - Em-dash (—)
   - Smart quotes (" ")
   - Zero-width spaces
   - Інші приховані Unicode символи

**Що перевірити:**
- ✅ Human Mode: всі AI-індикатори видалені (humanize завжди увімкнено)
- ✅ SEO Mode з Humanize: AI-індикатори видалені
- ✅ SEO Mode без Humanize: можуть бути присутні AI-індикатори

## Чеклист для фінального тестування

### Функціональність
- [ ] Feature flag працює коректно
- [ ] SEO Mode генерує SEO-оптимізовані статті
- [ ] Human Mode генерує редакційні статті
- [ ] Перемикання між режимами працює
- [ ] Режим зберігається між сесіями
- [ ] Humanize автоматично увімкнено в Human Mode
- [ ] Humanize налаштування приховані в Human Mode
- [ ] Humanize налаштування доступні в SEO Mode

### UI/UX
- [ ] Toggle Writing Mode відображається тільки з feature flag
- [ ] Поточний режим візуально виділений
- [ ] Інформаційне повідомлення показується в Human Mode
- [ ] Налаштування Humanize з'являються/зникають коректно
- [ ] Немає помилок в консолі браузера

### API та Backend
- [ ] `writingMode` передається коректно в API
- [ ] `effectiveHumanizeOnWrite` завжди `true` для Human Mode
- [ ] Статті генеруються з правильним промптом
- [ ] Humanization процес працює коректно

### Якість контенту
- [ ] SEO Mode має SEO-структуру
- [ ] Human Mode має редакційну структуру
- [ ] AI-індикатори видаляються в Human Mode
- [ ] Текст відповідає вимогам режиму
- [ ] Word count дотримується в обох режимах

## Відомі обмеження та примітки

1. **Human Mode завжди використовує Humanize**: Навіть якщо toggle вимкнений, Human Mode автоматично увімкнює humanization. Це задумано.

2. **Feature flag контролює UI**: Якщо feature flag вимкнений, Human Mode недоступний через UI, але backend підтримує обидва режими.

3. **Збереження стану**: Режим зберігається в localStorage, тому він персистентний між сесіями.

4. **Topic Discovery vs Direct Mode**: Обидва режими підтримують обидва Writing Modes, але використовують різні промпти.

## Як повідомити про проблеми

Якщо ви знайшли проблему під час тестування:

1. Зафіксуйте кроки для відтворення
2. Збережіть скріншоти або логи з консолі
3. Вкажіть:
   - Режим (SEO/Human)
   - Topic Discovery або Direct Mode
   - Чи був увімкнений Humanize (для SEO Mode)
   - Очікувана vs фактична поведінка

## Додаткові ресурси

- `lib/articlePrompt.ts` - промпти для обох режимів
- `lib/config.ts` - feature flag налаштування
- `app/api/articles/route.ts` - API endpoint для генерації статей
- `app/page.tsx` - UI компоненти для режимів
- `HUMANIZATION.md` - документація про humanization процес
